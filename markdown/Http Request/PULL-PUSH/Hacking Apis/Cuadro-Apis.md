### CUADRO

| Risk                                                                                                                                                                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                | May ask you                                                                                                                                                                                                                                                                                                                                                           |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [API1:2023 - Broken Object Level Authorization](https://owasp.org/API-Security/editions/2023/en/0xa1-broken-object-level-authorization/)                             | APIs tend to expose endpoints that handle object identifiers, creating a wide attack surface of Object Level Access Control issues. Object level authorization checks should be considered in every function that accesses a data source using an ID from the user.                                                                                                                                                                        | - **Question**: What happens if I modify the object identifier (ID) in a request (e.g., changing user ID in the URL or JSON)?<br>- **Objective**: Test if changing parameters like IDs allows you to access, modify, or delete data that doesn't belong to you. This can expose data from other users.                                                                |
| [API2:2023 - Broken Authentication](https://owasp.org/API-Security/editions/2023/en/0xa2-broken-authentication/)                                                     | Authentication mechanisms are often implemented incorrectly, allowing attackers to compromise authentication tokens or to exploit implementation flaws to assume other user's identities temporarily or permanently. Compromising a system's ability to identify the client/user, compromises API security overall.                                                                                                                        | - **Question**: Are there any weak points in the authentication mechanism (e.g., weak password requirements, lack of account lockout, or predictable tokens)?<br>- **Objective**: Check if you can bypass authentication mechanisms, brute force credentials, or access APIs without proper authentication tokens.                                                    |
| [API3:2023 - Broken Object Property Level Authorization](https://owasp.org/API-Security/editions/2023/en/0xa3-broken-object-property-level-authorization/)           | This category combines [API3:2019 Excessive Data Exposure](https://owasp.org/API-Security/editions/2019/en/0xa3-excessive-data-exposure/) and [API6:2019 - Mass Assignment](https://owasp.org/API-Security/editions/2019/en/0xa6-mass-assignment/), focusing on the root cause: the lack of or improper authorization validation at the object property level. This leads to information exposure or manipulation by unauthorized parties. | - **Question**: Can I access or modify sensitive fields of an object that I shouldn’t be able to (e.g., modifying `admin:true` in a request)?<br>- **Objective**: Test whether individual properties of an object are being properly restricted to authorized users. Can you read or modify sensitive object properties that shouldn't be exposed?                    |
| [API4:2023 - Unrestricted Resource Consumption](https://owasp.org/API-Security/editions/2023/en/0xa4-unrestricted-resource-consumption/)                             | Satisfying API requests requires resources such as network bandwidth, CPU, memory, and storage. Other resources such as emails/SMS/phone calls or biometrics validation are made available by service providers via API integrations, and paid for per request. Successful attacks can lead to Denial of Service or an increase of operational costs.                                                                                      | - **Question**: What happens if I send a high volume of requests or request a large amount of data? Are there limits in place to protect server resources?<br>- **Objective**: Test for rate limiting and resource limits. Can you overwhelm the API or consume too many resources, potentially causing Denial of Service (DoS)?                                      |
| [API5:2023 - Broken Function Level Authorization](https://owasp.org/API-Security/editions/2023/en/0xa5-broken-function-level-authorization/)                         | Complex access control policies with different hierarchies, groups, and roles, and an unclear separation between administrative and regular functions, tend to lead to authorization flaws. By exploiting these issues, attackers can gain access to other users’ resources and/or administrative functions.                                                                                                                               | - **Question**: Can I access administrative or privileged functions as a regular user (e.g., sending a POST request to create a new admin account or delete users)?<br>- **Objective**: Check if you can perform actions or access API endpoints that are restricted to more privileged users (e.g., admin functions) by manipulating the request method or endpoint. |
| [API6:2023 - Unrestricted Access to Sensitive Business Flows](https://owasp.org/API-Security/editions/2023/en/0xa6-unrestricted-access-to-sensitive-business-flows/) | APIs vulnerable to this risk expose a business flow - such as buying a ticket, or posting a comment - without compensating for how the functionality could harm the business if used excessively in an automated manner. This doesn't necessarily come from implementation bugs.                                                                                                                                                           | - **Question**: Can I abuse a business workflow or action (e.g., reserving all available items or resources, purchasing items without limits)?<br>- **Objective**: Test if sensitive business processes (e.g., reservations, purchases, or account actions) are restricted properly. Look for ways to overuse or exploit business flows that could harm the business. |
| [API7:2023 - Server Side Request Forgery](https://owasp.org/API-Security/editions/2023/en/0xa7-server-side-request-forgery/)                                         | Server-Side Request Forgery (SSRF) flaws can occur when an API is fetching a remote resource without validating the user-supplied URI. This enables an attacker to coerce the application to send a crafted request to an unexpected destination, even when protected by a firewall or a VPN.                                                                                                                                              | - **Question**: Can I manipulate a URL parameter to make the server request internal resources (e.g., a local file or an internal service)?<br>- **Objective**: Test if user-supplied URLs are validated before being requested by the server. Can you get the server to request an unintended resource, such as internal services or other websites?                 |
| [API8:2023 - Security Misconfiguration](https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/)                                             | APIs and the systems supporting them typically contain complex configurations, meant to make the APIs more customizable. Software and DevOps engineers can miss these configurations, or don't follow security best practices when it comes to configuration, opening the door for different types of attacks.                                                                                                                             | - **Question**: Are there misconfigurations in the API server or infrastructure (e.g., open debug pages, verbose error messages, exposed credentials)?<br>- **Objective**: Look for configuration errors that expose sensitive information. This includes exposed error messages, insecure headers, and open endpoints that should be protected.                      |
| [API9:2023 - Improper Inventory Management](https://owasp.org/API-Security/editions/2023/en/0xa9-improper-inventory-management/)                                     | APIs tend to expose more endpoints than traditional web applications, making proper and updated documentation highly important. A proper inventory of hosts and deployed API versions also are important to mitigate issues such as deprecated API versions and exposed debug endpoints.                                                                                                                                                   | - **Question**: Are there outdated or undocumented APIs that expose functionality or data (e.g., old versions of the API with vulnerabilities)?<br>- **Objective**: Identify older, deprecated APIs or endpoints that are still accessible but might not have been updated with the latest security fixes.                                                            |
| [API10:2023 - Unsafe Consumption of APIs](https://owasp.org/API-Security/editions/2023/en/0xaa-unsafe-consumption-of-apis/)                                          | Developers tend to trust data received from third-party APIs more than user input, and so tend to adopt weaker security standards. In order to compromise APIs, attackers go after integrated third-party services instead of trying to compromise the target API directly.                                                                                                                                                                | - **Question**: Does the API blindly trust data from third-party services (e.g., unsanitized data from another API)?<br>- **Objective**: Check how the API interacts with third-party services. Can you manipulate or inject data that causes harmful effects, like SQL injection or malicious file uploads?                                                          |
#### Example Questions by Vulnerability Type:

- **BOLA**: Can I change the user ID, account number, or other object identifiers to access data belonging to someone else?
- **Broken Authentication**: Can I bypass the login process? Can I use weak credentials or reuse tokens to authenticate as someone else?
- **Broken Object Property Level Authorization**: Can I modify an object property (like `admin:true`) to escalate privileges?
- **Unrestricted Resource Consumption**: What happens if I make a lot of requests or request a large dataset? Can I crash the system?
- **Broken Function Level Authorization**: Can I access administrative or restricted functionality by changing the HTTP method or URL path?
- **SSRF**: Can I manipulate URL parameters to make the server request an internal service or access internal files?
- **Security Misconfiguration**: Can I find sensitive information in error messages or open configuration files (e.g., `/.env`, debug pages)?
- **Improper Inventory Management**: Are there hidden or outdated API versions that expose vulnerable functionality?
- **Unsafe Consumption of APIs**: Does the API accept untrusted data from external services without sanitizing or validating it?

By systematically asking these questions and testing the API accordingly, you can cover a wide range of potential vulnerabilities in your penetration testing efforts.
